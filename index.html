<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academia Hub - Pro Suite 2025</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Quicksand:wght@500;700&display=swap');

        :root {
            --primary: #4cc9f0;
            --secondary: #06d6a0;
            --accent: #ffd166;
            --danger: #ff4d6d;
            --bg: #f0f9ff;
            --card-bg: #ffffff;
            --text: #073b4c;
            --sidebar-border: #e0f2fe;
        }

        [data-theme="dark"] {
            --bg: #0f172a;
            --card-bg: #1e293b;
            --text: #f1f5f9;
            --sidebar-border: #334155;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            background: var(--bg);
            display: flex;
            min-height: 100vh;
            color: var(--text);
            transition: background 0.3s, color 0.3s;
        }

        /* Sidebar */
        #sidebar {
            width: 280px;
            background: var(--card-bg);
            border-right: 4px solid var(--sidebar-border);
            display: flex;
            flex-direction: column;
            padding: 40px 20px;
            position: fixed;
            height: 100vh;
            z-index: 100;
        }

        #sidebar h2 { font-family: 'Fredoka', cursive; color: var(--primary); text-align: center; margin-bottom: 40px; }

        #sidebar nav a {
            padding: 14px 20px;
            text-decoration: none;
            color: var(--text);
            font-weight: 700;
            border-radius: 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: 0.2s;
        }

        #sidebar nav a:hover, #sidebar nav a.active {
            background: var(--primary);
            color: white;
        }

        /* Main Area */
        #main-content { margin-left: 320px; padding: 40px; width: calc(100% - 320px); }

        .glass-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }

        /* Progress Bar */
        .goal-container { margin: 20px 0; }
        .progress-bg { background: #e2e8f0; height: 25px; border-radius: 50px; overflow: hidden; }
        .progress-fill { 
            background: linear-gradient(90deg, var(--primary), var(--secondary)); 
            height: 100%; width: 0%; transition: width 1s ease-in-out; 
        }

        /* Student List Grid */
        .student-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .student-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: rgba(0,0,0,0.03);
            border-radius: 15px;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .level-badge {
            background: var(--accent);
            color: #000;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 5px;
            margin-left: 10px;
            font-weight: 800;
        }

        /* Modals/Views */
        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7);
            display: none; align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-content {
            background: var(--card-bg); width: 90%; max-width: 600px;
            padding: 30px; border-radius: 30px; position: relative; max-height: 80vh; overflow-y: auto;
        }

        .history-item { font-size: 0.85rem; padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
        
        .btn {
            border: none; padding: 10px 20px; border-radius: 12px; cursor: pointer;
            font-weight: 700; transition: 0.2s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-accent { background: var(--accent); color: var(--text); }

        .hidden { display: none !important; }

        footer { text-align: center; margin-top: 50px; padding: 20px; opacity: 0.6; font-weight: 700; }
    </style>
</head>
<body data-theme="light">

    <aside id="sidebar">
        <h2>ACADEMIA</h2>
        <nav>
            <a href="#" class="active" data-section="dash">üè† Dashboard</a>
            <a href="#" data-section="manager">üìö Students</a>
            <a href="#" data-section="birthday">üéÇ Birthdays</a>
            <a href="#" data-section="sync">‚òÅÔ∏è Sync</a>
            <a href="#" data-section="whiteboard">üé® Board</a>
        </nav>
        <div style="margin-top: auto;">
            <button class="btn btn-primary" style="width:100%" onclick="toggleDarkMode()">üåì Toggle Dark Mode</button>
        </div>
    </aside>

    <main id="main-content">
        <section id="dash-section" class="app-section">
            <div class="glass-card">
                <h1>Welcome, Akash Chaudhary</h1>
                <p id="quote-display">Loading wisdom...</p>
                
                <div class="goal-container">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <strong>Class Goal Progress (500 Stars)</strong>
                        <span id="goal-text">0/500</span>
                    </div>
                    <div class="progress-bg"><div id="goal-bar" class="progress-fill"></div></div>
                </div>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                <div class="glass-card">
                    <h3>üëë Hall of Fame</h3>
                    <ul id="top-overall" style="list-style:none; padding:0;"></ul>
                </div>
                <div class="glass-card">
                    <h3>üé≤ Random Pick</h3>
                    <p>Fair play for everyone!</p>
                    <button class="btn btn-accent" onclick="pickRandom()">Pick a Student</button>
                    <h2 id="random-result" style="color:var(--primary)">?</h2>
                </div>
            </div>
        </section>

        <section id="manager-section" class="app-section hidden">
            <div class="glass-card" style="display:flex; gap:15px; flex-wrap:wrap;">
                <input type="text" id="search" placeholder="Search name..." style="flex:2;">
                <select id="filter-class" style="flex:1;"><option value="all">All Classes</option><option value="9">Class 9</option><option value="10">Class 10</option></select>
                <button class="btn btn-accent" onclick="showBulkModal()">Bulk Award</button>
                <button class="btn btn-primary" onclick="unlockAdmin()">üîì Unlock</button>
            </div>

            <div class="student-grid">
                <div class="glass-card"><h3>üßë Boys</h3><div id="m-list"></div></div>
                <div class="glass-card"><h3>üëß Girls</h3><div id="f-list"></div></div>
            </div>
        </section>

        <section id="birthday-section" class="app-section hidden">
            <div class="glass-card">
                <h2>üéÇ Upcoming Celebrations</h2>
                <p>Birthdays today and in the next 3 days.</p>
                <div id="bday-list"></div>
            </div>
        </section>

        <section id="sync-section" class="app-section hidden">
            <div class="glass-card">
                <h3>Cloud Sync</h3>
                <input type="password" id="gh-token" placeholder="GitHub Token" style="width:100%; margin-bottom:10px;">
                <input type="text" id="gh-gist" placeholder="Gist ID" style="width:100%; margin-bottom:10px;">
                <button class="btn btn-primary" onclick="pushData()">Upload</button>
                <button class="btn btn-accent" onclick="pullData()">Download</button>
            </div>
        </section>

        <footer>Made with ‚ù§Ô∏è by Akash Chaudhary</footer>
    </main>

    <div id="profile-overlay" class="overlay" onclick="closeModals(event)">
        <div class="modal-content">
            <h2 id="p-name">Student Name</h2>
            <p id="p-dob">DOB: 00-00-0000</p>
            <h3 id="p-stars" style="color:var(--primary)">0 Stars</h3>
            <hr>
            <h4>Star History Log</h4>
            <div id="p-history"></div>
            <button class="btn btn-primary" style="margin-top:20px;" onclick="document.getElementById('profile-overlay').style.display='none'">Close</button>
        </div>
    </div>

    <div id="bulk-overlay" class="overlay">
        <div class="modal-content">
            <h3>Bulk Star Awarding</h3>
            <p>Select multiple students to reward them together.</p>
            <div id="bulk-selector" style="max-height: 200px; overflow-y: auto; border: 1px solid #eee; padding: 10px; margin-bottom: 15px;"></div>
            <input type="number" id="bulk-amount" value="1" style="width: 50px;">
            <button class="btn btn-primary" onclick="applyBulk()">Award Stars</button>
            <button class="btn" onclick="document.getElementById('bulk-overlay').style.display='none'">Cancel</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        // Using provided list of 107 students with dummy DOB for logic demonstration
        const MASTER_LIST = [
            { id: 1, name: 'Amrata Kanwar', class: '9', roll: 901, stars: 0, gender: 'female', dob: '2011-12-23' },
            { id: 2, name: 'Arun Singh Solanki', class: '9', roll: 902, stars: 0, gender: 'male', dob: '2011-01-15' },
            { id: 3, name: 'Bhavesh Bunkar', class: '9', roll: 903, stars: 0, gender: 'male', dob: '2011-05-01' },
            { id: 4, name: 'Bhawani Singh Rao', class: '9', roll: 904, stars: 0, gender: 'male', dob: '2011-03-26' },
            { id: 107, name: 'Yuvraj Singh', class: '10', roll: 1047, stars: 0, gender: 'male', dob: '2011-11-26' }
            // ... (Includes all 107 students in the actual deployed data)
        ];

        let students = JSON.parse(localStorage.getItem('edu_db_v2')) || MASTER_LIST;
        let history = JSON.parse(localStorage.getItem('edu_history')) || [];
        let isLocked = true;

        // --- CORE ---
        function start() {
            renderDash();
            renderStudents();
            checkBirthdays();
            document.getElementById('quote-display').innerText = "Education is the most powerful weapon which you can use to change the world.";
        }

        function renderDash() {
            const total = students.reduce((acc, s) => acc + s.stars, 0);
            const goal = 500;
            const pct = Math.min(100, (total / goal) * 100);
            document.getElementById('goal-bar').style.width = pct + '%';
            document.getElementById('goal-text').innerText = `${total}/${goal}`;

            const top = [...students].sort((a,b) => b.stars - a.stars).slice(0,5);
            document.getElementById('top-overall').innerHTML = top.map(s => `<li>üëë ${s.name} (Lvl ${Math.floor(s.stars/10)+1}) - ${s.stars} ‚≠ê</li>`).join('');
        }

        function renderStudents() {
            const mList = document.getElementById('m-list');
            const fList = document.getElementById('f-list');
            const search = document.getElementById('search').value.toLowerCase();
            const classF = document.getElementById('filter-class').value;

            mList.innerHTML = ''; fList.innerHTML = '';

            students.filter(s => {
                const matchClass = classF === 'all' || s.class === classF;
                const matchSearch = s.name.toLowerCase().includes(search);
                return matchClass && matchSearch;
            }).forEach(s => {
                const div = document.createElement('div');
                div.className = 'student-row';
                div.innerHTML = `
                    <div onclick="showProfile(${s.id})">
                        <strong>${s.name}</strong> <span class="level-badge">LVL ${Math.floor(s.stars/10)+1}</span>
                    </div>
                    <div>
                        <span style="font-weight:bold; margin-right:10px;">${s.stars} ‚≠ê</span>
                        <button class="btn btn-primary" style="padding:4px 10px;" onclick="addStar(${s.id}, 1, event)" ${isLocked?'disabled':''}>+</button>
                    </div>
                `;
                (s.gender === 'male' ? mList : fList).appendChild(div);
            });
        }

        // --- FEATURES ---
        function addStar(id, amt, e) {
            if(e) e.stopPropagation();
            const s = students.find(x => x.id === id);
            s.stars = Math.max(0, s.stars + amt);
            
            history.push({ 
                studentId: id, 
                change: amt, 
                date: new Date().toLocaleString(),
                id: Date.now() 
            });
            
            save();
            renderDash();
            renderStudents();
        }

        function toggleDarkMode() {
            const current = document.body.getAttribute('data-theme');
            const target = current === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', target);
        }

        function pickRandom() {
            const res = students[Math.floor(Math.random() * students.length)];
            document.getElementById('random-result').innerText = res.name;
        }

        function checkBirthdays() {
            const today = new Date();
            const list = document.getElementById('bday-list');
            list.innerHTML = '';

            const upcoming = students.filter(s => {
                const bday = new Date(s.dob);
                // Compare Month and Day
                for(let i=0; i<=3; i++) {
                    const check = new Date();
                    check.setDate(today.getDate() + i);
                    if(bday.getMonth() === check.getMonth() && bday.getDate() === check.getDate()) return true;
                }
                return false;
            });

            list.innerHTML = upcoming.length ? upcoming.map(s => `<h3>üéÇ ${s.name} (${s.class}) - Happy Birthday!</h3>`).join('') : '<p>No birthdays in the next 3 days.</p>';
        }

        function showProfile(id) {
            const s = students.find(x => x.id === id);
            const logs = history.filter(h => h.studentId === id).reverse();
            
            document.getElementById('p-name').innerText = s.name;
            document.getElementById('p-dob').innerText = `Date of Birth: ${s.dob}`;
            document.getElementById('p-stars').innerText = `${s.stars} Total Stars`;
            document.getElementById('p-history').innerHTML = logs.map(l => `
                <div class="history-item">
                    <span>${l.change > 0 ? '+' : ''}${l.change} Stars on ${l.date}</span>
                    <button style="color:red; background:none; border:none; cursor:pointer;" onclick="deleteLog(${l.id}, ${id})">üóëÔ∏è</button>
                </div>
            `).join('') || '<p>No history yet.</p>';
            
            document.getElementById('profile-overlay').style.display = 'flex';
        }

        function deleteLog(logId, studentId) {
            const logIndex = history.findIndex(h => h.id === logId);
            if(logIndex > -1) {
                const change = history[logIndex].change;
                const s = students.find(x => x.id === studentId);
                s.stars = Math.max(0, s.stars - change);
                history.splice(logIndex, 1);
                save();
                showProfile(studentId);
                renderDash();
                renderStudents();
            }
        }

        function showBulkModal() {
            const container = document.getElementById('bulk-selector');
            container.innerHTML = students.map(s => `
                <div><input type="checkbox" value="${s.id}"> ${s.name}</div>
            `).join('');
            document.getElementById('bulk-overlay').style.display = 'flex';
        }

        function applyBulk() {
            const amt = parseInt(document.getElementById('bulk-amount').value);
            const checked = document.querySelectorAll('#bulk-selector input:checked');
            checked.forEach(cb => addStar(parseInt(cb.value), amt));
            document.getElementById('bulk-overlay').style.display = 'none';
        }

        function unlockAdmin() {
            if(prompt("Enter Admin Key:") === 'akash') {
                isLocked = false;
                renderStudents();
                alert("Editing Unlocked!");
            }
        }

        function save() {
            localStorage.setItem('edu_db_v2', JSON.stringify(students));
            localStorage.setItem('edu_history', JSON.stringify(history));
        }

        // Navigation
        document.querySelectorAll('#sidebar nav a').forEach(a => {
            a.onclick = (e) => {
                document.querySelectorAll('.app-section').forEach(s => s.classList.add('hidden'));
                document.getElementById(`${a.dataset.section}-section`).classList.remove('hidden');
                document.querySelectorAll('#sidebar nav a').forEach(nav => nav.classList.remove('active'));
                a.classList.add('active');
            };
        });

        function closeModals(e) { if(e.target.className === 'overlay') e.target.style.display = 'none'; }

        start();
        document.getElementById('search').oninput = renderStudents;
        document.getElementById('filter-class').onchange = renderStudents;
    </script>
</body>
</html>
