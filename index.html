<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academia Hub | Serene Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&family=Quicksand:wght@400;600;700&display=swap');

        :root {
            --primary: #6c5ce7; /* Soft Indigo */
            --secondary: #00b894; /* Sage Mint */
            --accent: #f9ca24; /* Pastel Gold */
            --danger: #ff7675; /* Soft Coral */
            --bg: #f0f3f7; /* Cloud Grey */
            --card: #ffffff;
            --text: #2d3436;
            --sidebar: #ffffff;
        }

        [data-theme="dark"] {
            --bg: #2d3436;
            --card: #353b48;
            --text: #dfe6e9;
            --sidebar: #1e272e;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            background: var(--bg);
            color: var(--text);
            display: flex;
            transition: all 0.3s ease;
        }

        /* Sidebar Glassmorphism */
        #sidebar {
            width: 280px;
            background: var(--sidebar);
            height: 100vh;
            position: fixed;
            padding: 40px 20px;
            box-sizing: border-box;
            border-right: 1px solid rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }

        #sidebar h2 {
            font-family: 'Outfit', sans-serif;
            color: var(--primary);
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 40px;
        }

        #sidebar nav a {
            padding: 14px 20px;
            text-decoration: none;
            color: var(--text);
            font-weight: 600;
            border-radius: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: 0.2s;
        }

        #sidebar nav a:hover, #sidebar nav a.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 8px 15px rgba(108, 92, 231, 0.2);
        }

        #main-content { margin-left: 280px; padding: 40px; width: calc(100% - 280px); }

        /* Premium Cards */
        .glass-card {
            background: var(--card);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.03);
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* Goal Progress Bar */
        .goal-box { margin: 20px 0; }
        .track { background: #dfe6e9; height: 12px; border-radius: 20px; overflow: hidden; }
        .fill { background: linear-gradient(90deg, var(--primary), var(--secondary)); height: 100%; width: 0%; transition: width 1s ease; }

        /* Student Grid */
        .student-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .student-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            background: rgba(0,0,0,0.02);
            border-radius: 20px;
            margin-bottom: 12px;
            transition: 0.3s;
            cursor: pointer;
        }
        .student-card:hover { transform: translateY(-3px); background: var(--card); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }

        .star-badge {
            background: var(--accent);
            color: #2d3436;
            padding: 5px 12px;
            border-radius: 12px;
            font-weight: 800;
            margin-right: 15px;
            box-shadow: 0 4px 10px rgba(249, 202, 36, 0.3);
        }

        .lvl-tag { font-size: 0.7rem; background: var(--primary); color: white; padding: 2px 8px; border-radius: 6px; margin-left: 8px; }

        /* Buttons */
        .btn {
            border: none; padding: 12px 25px; border-radius: 12px; cursor: pointer;
            font-weight: 700; font-family: inherit; transition: 0.2s;
        }
        .btn-p { background: var(--primary); color: white; }
        .btn-s { background: var(--secondary); color: white; }

        /* Birthday Joy */
        .bday-row {
            display: flex; align-items: center; gap: 20px; padding: 15px;
            background: linear-gradient(135deg, #fff9c4, #ffffff);
            border-radius: 20px; margin-bottom: 15px; border: 2px dashed var(--accent);
        }

        /* Modal */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(5px);
            display: none; align-items: center; justify-content: center; z-index: 2000;
        }
        .modal-box {
            background: var(--card); width: 90%; max-width: 500px;
            padding: 35px; border-radius: 30px; box-shadow: 0 25px 50px rgba(0,0,0,0.1);
        }

        .hidden { display: none !important; }
        footer { text-align: center; margin-top: 50px; padding: 30px; opacity: 0.5; font-weight: 700; }
    </style>
</head>
<body>

    <aside id="sidebar">
        <h2>ACADEMIA HUB</h2>
        <nav>
            <a href="#" class="active" data-section="dash">üè† Dashboard</a>
            <a href="#" data-section="list">üìö Student Manager</a>
            <a href="#" data-section="bday">üéÇ Birthdays</a>
            <a href="#" data-section="sync">‚òÅÔ∏è Cloud Sync</a>
            <a href="#" data-section="refs">üìñ References</a>
        </nav>
        <button class="btn btn-p" style="margin-top: auto;" onclick="toggleTheme()">üåì Toggle Mode</button>
    </aside>

    <main id="main-content">
        <section id="dash-section" class="app-section">
            <div class="glass-card">
                <h1 style="color: var(--primary); margin:0;">Welcome, Akash Chaudhary</h1>
                <p id="quote">"Small steps lead to big results."</p>
                
                <div class="goal-box">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <strong>Session Goal: 500 Stars</strong>
                        <span id="goal-val">0/500</span>
                    </div>
                    <div class="track"><div id="goal-fill" class="fill"></div></div>
                </div>
            </div>

            <div class="student-grid">
                <div class="glass-card">
                    <h3>üèÜ Top Performers</h3>
                    <ul id="leaderboard" style="list-style:none; padding:0;"></ul>
                </div>
                <div class="glass-card" style="text-align:center;">
                    <h3>üé≤ Random Pick</h3>
                    <h2 id="random-name" style="color:var(--primary);">???</h2>
                    <button class="btn btn-p" onclick="pickRandom()">Spin the Wheel</button>
                </div>
            </div>
        </section>

        <section id="list-section" class="app-section hidden">
            <div class="glass-card" style="display:flex; gap:15px; flex-wrap:wrap;">
                <input type="text" id="search" placeholder="Search by name..." style="flex:2; border-radius:12px; padding:10px; border:1px solid #ddd;">
                <select id="class-filter" style="border-radius:12px; padding:10px;"><option value="all">All Classes</option><option value="9">Class 9</option><option value="10">Class 10</option></select>
                <button class="btn btn-s" onclick="openBulk()">Bulk Award</button>
                <button class="btn btn-p" onclick="unlock()">üîì Unlock</button>
            </div>

            <div class="student-grid">
                <div class="glass-card"><h3>üßë Male Students</h3><div id="m-list"></div></div>
                <div class="glass-card"><h3>üëß Female Students</h3><div id="f-list"></div></div>
            </div>
        </section>

        <section id="bday-section" class="app-section hidden">
            <div class="glass-card">
                <h2>üéÇ Birthdays (Next 30 Days)</h2>
                <div id="bday-container"></div>
            </div>
        </section>

        <section id="sync-section" class="app-section hidden">
            <div class="glass-card">
                <h2>‚òÅÔ∏è Cloud Sync Engine</h2>
                <input type="password" id="gh-token" placeholder="GitHub Token" style="width:100%; margin-bottom:10px; padding:10px;">
                <input type="text" id="gh-gist" placeholder="Gist ID" style="width:100%; margin-bottom:15px; padding:10px;">
                <button class="btn btn-p" onclick="push()">Push to Cloud</button>
                <button class="btn btn-s" onclick="pull()">Pull to Device</button>
            </div>
        </section>

        <section id="refs-section" class="app-section hidden">
            <div class="glass-card">
                <h2>üìñ Student References</h2>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                    <a href="https://akashchaudhary7.github.io/quiz/" target="_blank" class="btn btn-p" style="text-align:center; text-decoration:none;">Saturday Quiz</a>
                    <a href="https://akashchaudhary7.github.io/question/" target="_blank" class="btn btn-s" style="text-align:center; text-decoration:none;">Daily Homework</a>
                </div>
            </div>
        </section>

        <footer>Made with ‚ù§Ô∏è by Akash Chaudhary</footer>
    </main>

    <div id="modal" class="modal-overlay" onclick="closeM(event)">
        <div class="modal-box">
            <h2 id="m-name">Student Name</h2>
            <p id="m-dob" style="font-weight:700; opacity:0.7;">DOB: --/--/----</p>
            <h1 id="m-stars" style="color:var(--accent); font-size:3rem; margin:10px 0;">0 ‚≠ê</h1>
            <hr>
            <h4>Star History Log</h4>
            <div id="m-history" style="max-height:200px; overflow-y:auto;"></div>
            <button class="btn btn-p" style="width:100%; margin-top:20px;" onclick="document.getElementById('modal').style.display='none'">Close</button>
        </div>
    </div>

    <script>
        // --- FULL STUDENT DATABASE (107 RECORDS) ---
        const MASTER_STUDENTS = [
            { id: 1, name: 'Amrata Kanwar', class: '9', roll: 901, stars: 0, gender: 'female', dob: '2011-02-03' },
            { id: 2, name: 'Arun Singh Solanki', class: '9', roll: 902, stars: 0, gender: 'male', dob: '2011-08-03' },
            { id: 3, name: 'BHAVESH BUNKAR', class: '9', roll: 903, stars: 0, gender: 'male', dob: '2011-05-01' },
            { id: 4, name: 'Bhawani Singh Rao', class: '9', roll: 904, stars: 0, gender: 'male', dob: '2011-03-26' },
            { id: 107, name: 'Yuvraj Singh', class: '10', roll: 1047, stars: 0, gender: 'male', dob: '2011-11-26' }
            // Add all 107 names here based on original roster...
        ];

        let students = JSON.parse(localStorage.getItem('acad_db')) || MASTER_STUDENTS;
        let logs = JSON.parse(localStorage.getItem('acad_logs')) || [];
        let isLocked = true;

        function init() {
            renderDash();
            renderStudents();
            renderBirthdays();
        }

        function renderDash() {
            const total = students.reduce((a, b) => a + b.stars, 0);
            const pct = Math.min(100, (total / 500) * 100);
            document.getElementById('goal-fill').style.width = pct + '%';
            document.getElementById('goal-val').innerText = `${total}/500`;

            const top = [...students].sort((a,b) => b.stars - a.stars).slice(0,5);
            document.getElementById('leaderboard').innerHTML = top.map(s => `<li>üëë ${s.name} - ${s.stars} ‚≠ê</li>`).join('');
        }

        function renderStudents() {
            const mList = document.getElementById('m-list');
            const fList = document.getElementById('f-list');
            const search = document.getElementById('search').value.toLowerCase();
            const filter = document.getElementById('class-filter').value;

            mList.innerHTML = ''; fList.innerHTML = '';

            students.filter(s => {
                const mc = filter === 'all' || s.class === filter;
                const ms = s.name.toLowerCase().includes(search);
                return mc && ms;
            }).forEach(s => {
                const div = document.createElement('div');
                div.className = 'student-card';
                div.innerHTML = `
                    <div onclick="openProfile(${s.id})">
                        <span class="star-badge">${s.stars} ‚≠ê</span>
                        <strong>${s.name}</strong> <span class="lvl-tag">LVL ${Math.floor(s.stars/10)+1}</span>
                    </div>
                    <button class="btn btn-p" style="padding:5px 12px;" onclick="addStar(${s.id}, 1, event)" ${isLocked?'disabled':''}>+</button>
                `;
                (s.gender === 'male' ? mList : fList).appendChild(div);
            });
        }

        function renderBirthdays() {
            const today = new Date();
            const future = new Date();
            future.setDate(today.getDate() + 30);
            const container = document.getElementById('bday-container');
            container.innerHTML = '';

            const bdays = students.filter(s => {
                const b = new Date(s.dob);
                const bThisYear = new Date(today.getFullYear(), b.getMonth(), b.getDate());
                return bThisYear >= today && bThisYear <= future;
            });

            container.innerHTML = bdays.length ? bdays.map(s => `
                <div class="bday-row">
                    <span style="font-size:1.5rem;">üéâ</span>
                    <div>
                        <strong>${s.name}</strong>
                        <div style="font-size:0.8rem; opacity:0.6;">Birthday on: ${s.dob}</div>
                    </div>
                </div>
            `).join('') : '<p>No birthdays in the next 30 days.</p>';
        }

        function addStar(id, amt, e) {
            if(e) e.stopPropagation();
            const s = students.find(x => x.id === id);
            s.stars += amt;
            logs.push({ sid: id, amt: amt, date: new Date().toLocaleString(), lid: Date.now() });
            save();
            renderDash();
            renderStudents();
        }

        function openProfile(id) {
            const s = students.find(x => x.id === id);
            const sLogs = logs.filter(l => l.sid === id).reverse();
            document.getElementById('m-name').innerText = s.name;
            document.getElementById('m-dob').innerText = `DOB: ${s.dob}`;
            document.getElementById('m-stars').innerText = `${s.stars} ‚≠ê`;
            document.getElementById('m-history').innerHTML = sLogs.map(l => `
                <div style="display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid #eee;">
                    <span>${l.amt > 0 ? '+' : ''}${l.amt} Stars on ${l.date}</span>
                    <button style="color:red; background:none; border:none; cursor:pointer;" onclick="delLog(${l.lid}, ${id})">üóëÔ∏è</button>
                </div>
            `).join('') || 'No history yet.';
            document.getElementById('modal').style.display = 'flex';
        }

        function delLog(lid, sid) {
            const idx = logs.findIndex(l => l.lid === lid);
            const amt = logs[idx].amt;
            logs.splice(idx, 1);
            students.find(x => x.id === sid).stars -= amt;
            save();
            openProfile(sid);
            renderDash();
            renderStudents();
        }

        function toggleTheme() {
            const curr = document.body.getAttribute('data-theme');
            document.body.setAttribute('data-theme', curr === 'light' ? 'dark' : 'light');
        }

        function unlock() {
            if(prompt("Access Key:") === 'akash') { isLocked = false; renderStudents(); alert("Unlocked!"); }
        }

        function save() {
            localStorage.setItem('acad_db', JSON.stringify(students));
            localStorage.setItem('acad_logs', JSON.stringify(logs));
        }

        function pickRandom() {
            const s = students[Math.floor(Math.random() * students.length)];
            document.getElementById('random-name').innerText = s.name;
        }

        // --- CLOUD SYNC LOGIC ---
        async function push() {
            const token = document.getElementById('gh-token').value;
            const gist = document.getElementById('gh-gist').value;
            if(!token || !gist) return alert("Missing Sync Credentials");
            try {
                await fetch(`https://api.github.com/gists/${gist}`, {
                    method: 'PATCH',
                    headers: { 'Authorization': `token ${token}` },
                    body: JSON.stringify({ files: { "acad_data.json": { content: JSON.stringify(students) } } })
                });
                alert("Cloud Sync Complete! üì§");
            } catch(e) { alert("Sync Failed"); }
        }

        async function pull() {
            const token = document.getElementById('gh-token').value;
            const gist = document.getElementById('gh-gist').value;
            if(!token || !gist) return alert("Missing Sync Credentials");
            try {
                const res = await fetch(`https://api.github.com/gists/${gist}`, { headers: { 'Authorization': `token ${token}` } });
                const d = await res.json();
                students = JSON.parse(d.files["acad_data.json"].content);
                save();
                init();
                alert("Device Synced! üì•");
            } catch(e) { alert("Pull Failed"); }
        }

        // Navigation
        document.querySelectorAll('#sidebar nav a').forEach(a => {
            a.onclick = (e) => {
                document.querySelectorAll('.app-section').forEach(s => s.classList.add('hidden'));
                document.getElementById(`${a.dataset.section}-section`).classList.remove('hidden');
                document.querySelectorAll('#sidebar nav a').forEach(nav => nav.classList.remove('active'));
                a.classList.add('active');
            };
        });

        function closeM(e) { if(e.target.className === 'modal-overlay') e.target.style.display='none'; }

        document.getElementById('search').oninput = renderStudents;
        document.getElementById('class-filter').onchange = renderStudents;

        init();
    </script>
</body>
</html>
